2024-10-01 09:07:48,731 - __main__ - INFO - Factory App Version: 0.0.1
2024-10-01 09:07:48,731 - __main__ - INFO - Test 1 Start
2024-10-01 09:07:48,731 - __main__ - INFO - Below are information extracted based on ESP32S3 MAC Address
2024-10-01 09:07:48,731 - __main__ - INFO - order-no: hand-sample
2024-10-01 09:07:48,731 - __main__ - INFO -  mac-address: 34:85:18:50:fa:94
2024-10-01 09:07:48,731 - __main__ - INFO -  serial-id: A09000500
2024-10-01 09:07:48,731 - __main__ - INFO -  cert-id: Polyaire-DAC-0x146D-0x0001-A09000500-Cert
2024-10-01 09:07:48,731 - __main__ - INFO -  esp-secure-cert-partition: dc19b802-47e1-4c5b-bf01-5279442482fc_esp_secure_cert.bin
2024-10-01 09:07:48,731 - __main__ - INFO -  commissionable-data-provider-partition: dc19b802-47e1-4c5b-bf01-5279442482fc-partition.bin
2024-10-01 09:07:48,731 - __main__ - INFO -  qrcode: MT:Y1CA00O6148F-405J10
2024-10-01 09:07:48,732 - __main__ - INFO -  manualcode: 1169-154-3426
2024-10-01 09:07:48,732 - __main__ - INFO -  discriminator: 1428
2024-10-01 09:07:48,732 - __main__ - INFO -  passcode: 71139859
2024-10-01 09:07:48,732 - __main__ - INFO - Read ESP32S3 Mac Address
2024-10-01 09:07:48,732 - components.flashFirmware.flashFirmware - INFO - ESP32S3 MAC Address: 34:85:18:50:fa:94
2024-10-01 09:07:48,732 - components.flashFirmware.flashFirmware - INFO - Get ESP32S3 MAC Address Completed
2024-10-01 09:07:48,732 - __main__ - INFO - Read ESP32H2 MAC Address
2024-10-01 09:07:49,807 - __main__ - INFO - Flashing esp32s3 and esp32h2 firmware
2024-10-01 09:07:49,807 - __main__ - INFO - Erase Flash ESP32S3: True
2024-10-01 09:07:49,807 - __main__ - INFO - Erase Flash ESP32S3 Start Address: 0x0
2024-10-01 09:07:49,807 - __main__ - INFO - Erase Flash ESP32S3 End Address: 0x800000
2024-10-01 09:07:49,807 - __main__ - INFO - Erase Flash ESP32H2: True
2024-10-01 09:07:49,808 - __main__ - INFO - Erase Flash ESP32H2 Start Address: 0x0
2024-10-01 09:07:49,808 - __main__ - INFO - Erase Flash ESP32H2 End Address: 0x400000
2024-10-01 09:07:49,808 - __main__ - INFO - Flashing ESP32S3 firmware, Port: /dev/ttyUSB0, Baud: 460800
2024-10-01 09:07:49,808 - __main__ - INFO - ESP32S3 Bootloader Address: 0x0
2024-10-01 09:07:49,808 - __main__ - INFO - ESP32S3 Partition Table Address: 0xC000
2024-10-01 09:07:49,808 - __main__ - INFO - ESP32S3 OTA Data Initial Address: 0x1E000
2024-10-01 09:07:49,808 - __main__ - INFO - ESP32S3 Firmware Address: 0x1F0000
2024-10-01 09:07:49,808 - __main__ - INFO - ESP32S3 Use ESPTOOL: False
2024-10-01 09:07:49,808 - __main__ - INFO - Flashing ESP32H2 firmware, Port: /dev/ttyUSB2, Baud: 115200
2024-10-01 09:07:49,808 - __main__ - INFO - ESP32H2 Bootloader Address: 0x0
2024-10-01 09:07:49,808 - __main__ - INFO - ESP32H2 Partition Table Address: 0x8000
2024-10-01 09:07:49,808 - __main__ - INFO - ESP32H2 Firmware Address: 0x10000
2024-10-01 09:07:49,808 - __main__ - INFO - ESP32H2 Use ESPTOOL: True
2024-10-01 09:07:49,809 - components.flashFirmware.flashFirmware - INFO - Erase Flash ESP32S3: source /usr/src/app/esp/esp-idf/export.sh
openocd -f /home/airdroitech/.espressif/tools/openocd-esp32/v0.12.0-esp32-20240318/openocd-esp32/share/openocd/scripts/interface/esp_usb_jtag.cfg -f /home/airdroitech/.espressif/tools/openocd-esp32/v0.12.0-esp32-20240318/openocd-esp32/share/openocd/scripts/board/esp32s3-builtin.cfg --command 'init; reset init; flash erase_address 0x0 0x800000; shutdown'

2024-10-01 09:07:49,809 - components.flashFirmware.flashFirmware - ERROR - Error: Unable to find one or more bin files
2024-10-01 09:07:49,810 - components.flashFirmware.flashFirmware - INFO - Erase Flash ESP32S3 = /bin/bash: line 1: /usr/src/app/esp/esp-idf/export.sh: No such file or directory
2024-10-01 09:07:49,810 - components.flashFirmware.flashFirmware - INFO - Erase Flash ESP32S3 = /bin/bash: line 2: openocd: command not found
2024-10-01 09:07:50,811 - components.flashFirmware.flashFirmware - ERROR - Error: Unable to find one or more bin files
2024-10-01 09:07:50,811 - components.flashFirmware.flashFirmware - INFO - Flashing ESP32S3 Firmware: source /usr/src/app/esp/esp-idf/export.sh
openocd -f /home/airdroitech/.espressif/tools/openocd-esp32/v0.12.0-esp32-20240318/openocd-esp32/share/openocd/scripts/interface/esp_usb_jtag.cfg -f /home/airdroitech/.espressif/tools/openocd-esp32/v0.12.0-esp32-20240318/openocd-esp32/share/openocd/scripts/board/esp32s3-builtin.cfg --command 'program_esp /home/anuarrozman2303/Airdroitech/FactoryApp_Merge/FlashingTool/firmware/s3/ota_data_initial.bin 0x1E000; program_esp /home/anuarrozman2303/Airdroitech/FactoryApp_Merge/FlashingTool/firmware/s3/partition-table.bin 0xC000; program_esp /home/anuarrozman2303/Airdroitech/FactoryApp_Merge/FlashingTool/firmware/s3/bootloader.bin 0x0; program_esp /home/anuarrozman2303/Airdroitech/FactoryApp_Merge/FlashingTool/firmware/s3/ARCHIVE/partitions_8MB_TBR/v1_0_0-20240717-rc1.bin 0x1F0000 verify exit'

2024-10-01 09:07:50,812 - components.flashFirmware.flashFirmware - INFO - Flashing ESP32S3 Firmware = /bin/bash: line 1: /usr/src/app/esp/esp-idf/export.sh: No such file or directory
2024-10-01 09:07:50,812 - components.flashFirmware.flashFirmware - INFO - Flashing ESP32S3 Firmware = /bin/bash: line 2: openocd: command not found
2024-10-01 09:07:50,812 - components.flashFirmware.flashFirmware - WARNING - Flashing ESP32S3 Firmware Failed
2024-10-01 09:07:51,814 - __main__ - INFO - Flashing esp32s3 certificate
2024-10-01 09:07:51,814 - __main__ - INFO - Flashing esp32s3 certificate, Port: /dev/ttyUSB0, Baud: 460800
2024-10-01 09:07:51,814 - __main__ - INFO - ESP32S3 Secure Cert Partition Address: 0xD000
2024-10-01 09:07:51,814 - __main__ - INFO - ESP32S3 Data Provider Partition Address: 0x60000
2024-10-01 09:07:51,814 - __main__ - INFO - ESP32S3 DAC Use ESPTOOL: False
2024-10-01 09:07:51,814 - components.flashCert.flashCert - DEBUG - Cert file path: /home/anuarrozman2303/Airdroitech/FactoryApp/certs/A09000500/espsecurecert/out/146d_1/dc19b802-47e1-4c5b-bf01-5279442482fc/dc19b802-47e1-4c5b-bf01-5279442482fc_esp_secure_cert.bin
2024-10-01 09:07:51,814 - components.flashCert.flashCert - INFO - Flashing certificate with cert-id: /home/anuarrozman2303/Airdroitech/FactoryApp/certs/A09000500/espsecurecert/out/146d_1/dc19b802-47e1-4c5b-bf01-5279442482fc/dc19b802-47e1-4c5b-bf01-5279442482fc_esp_secure_cert.bin on port /dev/ttyUSB0
2024-10-01 09:07:51,814 - components.flashCert.flashCert - DEBUG - ESP Secure Cert /home/anuarrozman2303/Airdroitech/FactoryApp/certs/A09000500/espsecurecert/out/146d_1/dc19b802-47e1-4c5b-bf01-5279442482fc/dc19b802-47e1-4c5b-bf01-5279442482fc_esp_secure_cert.bin on port /dev/ttyUSB0...
2024-10-01 09:07:51,814 - components.flashCert.flashCert - DEBUG - Certify Process: Flashing cert with bin_path: /home/anuarrozman2303/Airdroitech/FactoryApp/certs/A09000500/espsecurecert/out/146d_1/dc19b802-47e1-4c5b-bf01-5279442482fc/dc19b802-47e1-4c5b-bf01-5279442482fc_esp_secure_cert.bin and part_bin_path: /home/anuarrozman2303/Airdroitech/FactoryApp/certs/A09000500/espsecurecert/out/146d_1/dc19b802-47e1-4c5b-bf01-5279442482fc/dc19b802-47e1-4c5b-bf01-5279442482fc-partition.bin
2024-10-01 09:07:51,814 - components.flashCert.flashCert - INFO - Flashing ESP32S3 Cert with command: source /usr/src/app/esp/esp-idf/export.sh
openocd -f /home/airdroitech/.espressif/tools/openocd-esp32/v0.12.0-esp32-20240318/openocd-esp32/share/openocd/scripts/interface/esp_usb_jtag.cfg -f /home/airdroitech/.espressif/tools/openocd-esp32/v0.12.0-esp32-20240318/openocd-esp32/share/openocd/scripts/board/esp32s3-builtin.cfg --command 'program_esp /home/anuarrozman2303/Airdroitech/FactoryApp/certs/A09000500/espsecurecert/out/146d_1/dc19b802-47e1-4c5b-bf01-5279442482fc/dc19b802-47e1-4c5b-bf01-5279442482fc_esp_secure_cert.bin 0xD000; program_esp /home/anuarrozman2303/Airdroitech/FactoryApp/certs/A09000500/espsecurecert/out/146d_1/dc19b802-47e1-4c5b-bf01-5279442482fc/dc19b802-47e1-4c5b-bf01-5279442482fc-partition.bin 0x60000 verify exit'
2024-10-01 09:07:51,815 - components.flashCert.flashCert - INFO - Flashing ESP32S3 Cert = /bin/bash: line 1: /usr/src/app/esp/esp-idf/export.sh: No such file or directory
2024-10-01 09:07:51,815 - components.flashCert.flashCert - INFO - Flashing ESP32S3 Cert = /bin/bash: line 2: openocd: command not found
2024-10-01 09:07:51,815 - components.flashCert.flashCert - INFO - FlashCert, Create New/Updata Database Start
2024-10-01 09:07:51,815 - components.flashCert.flashCert - DEBUG - Updating status for certId /home/anuarrozman2303/Airdroitech/FactoryApp/certs/A09000500/espsecurecert/out/146d_1/dc19b802-47e1-4c5b-bf01-5279442482fc/dc19b802-47e1-4c5b-bf01-5279442482fc_esp_secure_cert.bin
2024-10-01 09:07:51,815 - components.flashCert.flashCert - DEBUG - Filtered certId =  esp-secure-cert-partition: dc19b802-47e1-4c5b-bf01-5279442482fc_esp_secure_cert.bin
2024-10-01 09:07:51,815 - components.flashCert.flashCert - DEBUG - Filtered macAddress =  mac-address: 34:85:18:50:fa:94
2024-10-01 09:07:51,815 - components.flashCert.flashCert - DEBUG - Reading file: /home/anuarrozman2303/Airdroitech/FactoryApp/device_data.txt
2024-10-01 09:07:51,815 - components.flashCert.flashCert - INFO - Found in database =  mac-address: 34:85:18:50:fa:94
2024-10-01 09:07:51,816 - components.flashCert.flashCert - INFO - FlashCert, Create New/Updata Database End
2024-10-01 09:07:51,816 - __main__ - INFO - Test 1 Completed
2024-10-01 09:07:51,975 - __main__ - INFO - Test 2 Start
2024-10-01 09:07:51,975 - __main__ - INFO - Entering factory mode
2024-10-01 09:07:51,975 - __main__ - INFO - Reset Factory Mode Flag
2024-10-01 09:07:51,976 - __main__ - INFO - Open esp32s3 Factory Port
2024-10-01 09:07:51,976 - __main__ - INFO - factory Port: /dev/ttyUSB1, Baud: 115200
2024-10-01 09:07:51,976 - components.serialCom.serialCom - DEBUG - Opening port /dev/ttyUSB1 at 115200 baud
2024-10-01 09:07:51,980 - components.serialCom.serialCom - INFO - Opened port /dev/ttyUSB1 at 115200 baud
2024-10-01 09:07:51,980 - __main__ - INFO - Reboot esp32s3 and esp32h2
2024-10-01 09:07:51,980 - __main__ - INFO - Reboot esp32s3, Port: /dev/ttyUSB0, Baud: 460800
2024-10-01 09:07:51,980 - __main__ - INFO - Reboot esp32h2, Port: /dev/ttyUSB2, Baud: 115200
2024-10-01 09:07:51,980 - components.flashFirmware.flashFirmware - INFO - Reset ESP32H2: source /usr/src/app/esp/esp-idf/export.sh
esptool.py -p /dev/ttyUSB2 -b 115200 run

2024-10-01 09:07:51,981 - components.flashFirmware.flashFirmware - INFO - Reset ESP32H2 = /bin/bash: line 1: /usr/src/app/esp/esp-idf/export.sh: No such file or directory
2024-10-01 09:07:52,024 - components.flashFirmware.flashFirmware - INFO - Reset ESP32H2 = esptool.py v4.7.0
2024-10-01 09:07:52,024 - components.flashFirmware.flashFirmware - INFO - Reset ESP32H2 = Serial port /dev/ttyUSB2
2024-10-01 09:07:53,037 - components.flashFirmware.flashFirmware - INFO - Reset ESP32H2 = Connecting....
2024-10-01 09:07:53,037 - components.flashFirmware.flashFirmware - INFO - Reset ESP32H2 = Detecting chip type... ESP32-H2
2024-10-01 09:07:53,037 - components.flashFirmware.flashFirmware - INFO - Reset ESP32H2 = Chip is ESP32-H2 (revision v0.1)
2024-10-01 09:07:53,037 - components.flashFirmware.flashFirmware - INFO - Reset ESP32H2 = Features: BLE, IEEE802.15.4
2024-10-01 09:07:53,037 - components.flashFirmware.flashFirmware - INFO - Reset ESP32H2 = Crystal is 32MHz
2024-10-01 09:07:53,037 - components.flashFirmware.flashFirmware - INFO - Reset ESP32H2 = MAC: 48:31:b7:ff:fe:c0:19:80
2024-10-01 09:07:53,037 - components.flashFirmware.flashFirmware - INFO - Reset ESP32H2 = BASE MAC: 48:31:b7:c0:19:80
2024-10-01 09:07:53,037 - components.flashFirmware.flashFirmware - INFO - Reset ESP32H2 = MAC_EXT: ff:fe
2024-10-01 09:07:53,037 - components.flashFirmware.flashFirmware - INFO - Reset ESP32H2 = Uploading stub...
2024-10-01 09:07:53,037 - components.flashFirmware.flashFirmware - INFO - Reset ESP32H2 = Running stub...
2024-10-01 09:07:53,037 - components.flashFirmware.flashFirmware - INFO - Reset ESP32H2 = Stub running...
2024-10-01 09:07:53,037 - components.flashFirmware.flashFirmware - INFO - Reset ESP32H2 = Hard resetting via RTS pin...
2024-10-01 09:07:53,046 - components.flashFirmware.flashFirmware - INFO - Reset ESP32S3: source /usr/src/app/esp/esp-idf/export.sh
openocd -f /home/airdroitech/.espressif/tools/openocd-esp32/v0.12.0-esp32-20240318/openocd-esp32/share/openocd/scripts/interface/esp_usb_jtag.cfg -f /home/airdroitech/.espressif/tools/openocd-esp32/v0.12.0-esp32-20240318/openocd-esp32/share/openocd/scripts/board/esp32s3-builtin.cfg --command 'init; reset run; exit'

2024-10-01 09:07:53,047 - components.flashFirmware.flashFirmware - INFO - Reset ESP32S3 = /bin/bash: line 1: /usr/src/app/esp/esp-idf/export.sh: No such file or directory
2024-10-01 09:07:53,048 - components.flashFirmware.flashFirmware - INFO - Reset ESP32S3 = /bin/bash: line 2: openocd: command not found
2024-10-01 09:07:53,048 - __main__ - INFO - Start Wait 3
2024-10-01 09:07:56,048 - __main__ - INFO - Finish Wait 3
2024-10-01 09:07:57,049 - __main__ - INFO - Read MAC Address
2024-10-01 09:07:57,049 - __main__ - DEBUG - SerialCom, Sent: FF:3;MAC?
2024-10-01 09:07:57,049 - __main__ - INFO - Read MAC Address Command: FF:3;MAC?
2024-10-01 09:07:57,050 - __main__ - INFO - Reference MAC Address: 34:85:18:50:fa:94
2024-10-01 09:08:00,050 - __main__ - INFO - Read MAC Address: Failed
2024-10-01 09:08:00,051 - components.serialCom.serialCom - INFO - Close Serial Port
2024-10-01 09:08:00,051 - components.serialCom.serialCom - DEBUG - Close Port
2024-10-01 09:08:00,108 - components.serialCom.serialCom - ERROR - Exception in read_serial_data: 'NoneType' object cannot be interpreted as an integer
2024-10-01 09:08:00,108 - components.serialCom.serialCom - INFO - Exit Serial Com Loop
2024-10-01 09:08:00,108 - components.serialCom.serialCom - INFO - Serial Com Thread End
2024-10-01 09:09:25,507 - components.serialCom.serialCom - INFO - Close Serial Port
2024-10-01 09:09:25,508 - components.serialCom.serialCom - DEBUG - Port is not open.
